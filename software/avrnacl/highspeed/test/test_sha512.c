/*
 * File:   avrnacl-20130415/highspeed/test/test_sha512.c
 * Author: Michael Hutter, Peter Schwabe
 * Public Domain
 */

#include "crypto_hash_sha512.h"
#include "print.h"

static const unsigned char hash_digest[64] = {0xb8, 0x58, 0xde, 0x8a, 0x8e, 0x44, 0xd2, 0x34, 0xbe, 0x96, 0xe0, 0x73, 0xbd, 0x11, 0xe7, 0x7a,
  0x5e, 0xd4, 0xed, 0x41, 0xfd, 0xcd, 0x81, 0x46, 0xea, 0x14, 0xb1, 0xf9, 0x8e, 0xdc, 0x05, 0x0c,
  0x81, 0x6f, 0xd6, 0x35, 0x0c, 0xb6, 0x94, 0x3e, 0x41, 0x04, 0xd0, 0x00, 0x90, 0x1a, 0x6e, 0x65,
  0xad, 0xb2, 0xd7, 0xfe, 0x7f, 0x4a, 0xa5, 0xba, 0x16, 0xc4, 0xef, 0x7b, 0x92, 0xac, 0x27, 0x90};

void test_sha512()
{
  int i;
  unsigned char c[64];
  unsigned char in[32]={0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15,
						0x16, 0x17, 0x18, 0x19, 0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x30, 0x31};
  crypto_hash_sha512(c,in,32);
  for(i=0;i<64;i++)
    if(c[i] != hash_digest[i])
    {
      print("-1\r\n");
      return;
    }
  print("0\r\n");
}
